# æ­£å¼ç’°å¢ƒé·ç§»æ¸…å–®

## ğŸ“‹ ä»»å‹™ä¸€ï¼šç§»é™¤ Debug ç¨‹å¼ç¢¼

### Backend (worker.js)
ç™¼ç¾ **100+ console.log** éœ€è¦ç§»é™¤ï¼Œä¸»è¦åˆ†å¸ƒåœ¨ï¼š

**å¿…é ˆä¿ç•™çš„éŒ¯èª¤è™•ç†ï¼š**
- `console.error` - æ‰€æœ‰éŒ¯èª¤è¨Šæ¯å»ºè­°ä¿ç•™ï¼Œç”¨æ–¼ç”Ÿç”¢ç’°å¢ƒé™¤éŒ¯

**éœ€è¦ç§»é™¤çš„ Debug è¨Šæ¯ï¼š**
1. **API è·¯ç”±å±¤ (line 222-234)**
   - `[API] æ”¶åˆ° action`
   - `[API] å®Œæ•´ body`
   - åƒæ•¸åµæ¸¬æ—¥èªŒ

2. **ç™»å…¥åŠŸèƒ½ (line 393-422)**
   - `[LOGIN] Attempt`
   - `[LOGIN] Users query result`
   - `[LOGIN] Birthday comparison`
   - è©³ç´°çš„ç”Ÿæ—¥æ¯”å°æ—¥èªŒ

3. **è¨»å†ŠåŠŸèƒ½ (line 430-472)**
   - è¨»å†Šè³‡æ–™æ—¥èªŒ
   - æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼æª¢æŸ¥æ—¥èªŒ

4. **å•†å“æŸ¥è©¢ (line 480-588)**
   - æŸ¥è©¢çµæœæ•¸é‡
   - ç¯„ä¾‹å•†å“è³‡æ–™
   - ç´¯ç©å¼µæ•¸è¨ˆç®—è©³æƒ…

5. **è¨‚å–®æŸ¥è©¢ (line 595-763)**
   - `[ORDER_INFO]` ç³»åˆ—æ—¥èªŒ
   - èªè­‰æˆåŠŸæ—¥èªŒ
   - è¨‚å–®/åœ˜æ‹†æ•¸é‡
   - åœ˜æ‹†åˆ†é¡ Debug

6. **æ–°å¢è¨‚å–® (line 783-1017)**
   - `[ADD_ORDER]` ç³»åˆ—æ—¥èªŒï¼ˆæœ€å¤šï¼‰
   - body è©³ç´°å…§å®¹
   - æ¨™æº–åŒ–è¨‚å–®æ—¥èªŒ
   - å•†å“è³‡è¨Šæ—¥èªŒ
   - ç´¯ç©å¼µæ•¸è¨ˆç®—æ—¥èªŒ

**å»ºè­°ç­–ç•¥ï¼š**
- ä¿ç•™æ‰€æœ‰ `console.error`ï¼ˆéŒ¯èª¤è™•ç†ï¼‰
- ç§»é™¤æ‰€æœ‰ `console.log`ï¼ˆé™¤éæ˜¯é—œéµæ¥­å‹™é‚è¼¯ï¼‰
- ä¿ç•™é—œéµå®‰å…¨æª¢æŸ¥çš„éŒ¯èª¤è¨Šæ¯

---

### Frontend (index.html)
ç™¼ç¾ **100+ console.log** éœ€è¦ç§»é™¤ï¼Œä¸»è¦åˆ†å¸ƒåœ¨ï¼š

**éœ€è¦ç§»é™¤çš„ Debug è¨Šæ¯ï¼š**
1. **API å‘¼å«å±¤ (line 1912-1938)**
   - ç™¼é€è«‹æ±‚æ—¥èªŒï¼ˆå½©è‰² consoleï¼‰
   - HTTP ç‹€æ…‹ç¢¼æ—¥èªŒ
   - å›æ‡‰å…§å®¹æ—¥èªŒ

2. **é é¢åˆ‡æ› (line 2009-2046)**
   - è¨‚å–®/åœ˜æ‹†é‡æ–°è¼‰å…¥æ—¥èªŒ

3. **ç™»å…¥åŠŸèƒ½ (line 2347-2423)**
   - res ç‰©ä»¶è©³æƒ…
   - user å±¬æ€§é€ä¸€æ‰“å°

4. **è¨‚å–®é¡¯ç¤º (line 3602-3923)**
   - displayOrders åŸ·è¡Œç‹€æ…‹
   - ç¯©é¸æ¢ä»¶æ—¥èªŒ
   - è¨‚å–®çµ±è¨ˆæ—¥èªŒ
   - å¤§é‡ `[DEBUG]` æ¨™è¨˜æ—¥èªŒ

5. **çµå¸³ä»˜æ¬¾ (line 4070-4816)**
   - çµå¸³æŒ‰éˆ•ç‹€æ…‹
   - é¸æ“‡çš„è¨‚å–®è³‡è¨Š
   - ç¶ ç•Œä»˜æ¬¾è™•ç†æ—¥èªŒ
   - ä»˜æ¬¾ç¢ºèªä¸­ç‹€æ…‹æ›´æ–°
   - ä»˜æ¬¾è¨ˆç®—æ—¥èªŒ

**å»ºè­°ç­–ç•¥ï¼š**
- ä¿ç•™ `console.error`ï¼ˆéŒ¯èª¤è™•ç†ï¼‰
- ç§»é™¤æ‰€æœ‰å½©è‰² console æ—¥èªŒ
- ç§»é™¤æ‰€æœ‰ `[DEBUG]` æ¨™è¨˜æ—¥èªŒ
- ç§»é™¤æ‰€æœ‰è©³ç´°çš„ç‹€æ…‹è¿½è¹¤æ—¥èªŒ

---

### Admin (admin.html)
ç™¼ç¾ **27 å€‹ console.log**ï¼Œç›¸å°è¼ƒå°‘ï¼š

**éœ€è¦ç§»é™¤çš„ï¼š**
1. æœå°‹è¨‚å–®æ—¥èªŒ (line 1638-1641)
2. æ‰¹æ¬¡æ›´æ–°æ—¥èªŒ (line 1556-1576)
3. æ›´æ–°/åˆªé™¤æ“ä½œå›æ‡‰æ—¥èªŒ
4. å‡ºè²¨ç´€éŒ„è™•ç†æ—¥èªŒ (line 3667-3984)
5. æ–°å¢åœ˜æ‹†å›æ‡‰æ—¥èªŒ (line 3110)

**å»ºè­°ç­–ç•¥ï¼š**
- ä¿ç•™æ‰€æœ‰ `console.error`
- ç§»é™¤æ‰€æœ‰æ“ä½œå›æ‡‰æ—¥èªŒ
- ä¿æŒ admin é¢æ¿çš„åŸºæœ¬éŒ¯èª¤è¿½è¹¤

---

## ğŸ“Š ä»»å‹™äºŒï¼šè³‡æ–™è¡¨çµæ§‹æ¸…å–®

### æ ¸å¿ƒè³‡æ–™è¡¨ï¼ˆå¿…é ˆé·ç§»ï¼‰

#### 1. **users** (ç”¨æˆ¶è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- phone (VARCHAR(20), UNIQUE, NOT NULL) -- ç™»å…¥ç”¨
- nickname (VARCHAR(50))
- birthday (DATE) -- ç™»å…¥é©—è­‰ç”¨
- email (VARCHAR(100))
- address (TEXT)
- real_name (VARCHAR(100))
- cvs_store_name (VARCHAR(200)) -- è¶…å•†åº—å
- password (VARCHAR(4)) -- é ç•™
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_users_phone
- idx_users_nickname
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `phone, nickname, birthday, email, address, real_name, cvs_store_name`

---

#### 2. **orders** (è¨‚å–®è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- user_id (UUID, FK â†’ users.id)
- timestamp (TIMESTAMP, NOT NULL)
- item (VARCHAR(200)) -- å•†å“åç¨±
- card_no (VARCHAR(50)) -- å¡è™Ÿ
- quantity (INTEGER, DEFAULT 1)
- unit_price (DECIMAL(10,2)) -- å–®åƒ¹
- deposit (DECIMAL(10,2), DEFAULT 0) -- è¨‚é‡‘
- balance_amount (DECIMAL(10,2)) -- å°¾æ¬¾é‡‘é¡
- total_fee (DECIMAL(10,2), NOT NULL) -- ç¸½é‡‘é¡
- status (VARCHAR(50), DEFAULT 'å·²é€šçŸ¥') -- ä»˜æ¬¾ç‹€æ…‹
- payment_method (VARCHAR(50))
- is_notified (BOOLEAN, DEFAULT FALSE)
- is_cleared (BOOLEAN, DEFAULT FALSE) -- æ˜¯å¦å·²çµæ¸…
- is_invoiced (VARCHAR(10))
- is_shipped (VARCHAR(10)) -- æ˜¯å¦å·²å‡ºè²¨
- arrival_status (VARCHAR(50)) -- åˆ°è²¨ç‹€æ…‹
- image_url (TEXT)
- box_order (VARCHAR(100)) -- æ•´ç›’è¨‚è³¼æ¨™è¨˜
- merchant_trade_no (VARCHAR(100)) -- ç¶ ç•Œäº¤æ˜“ç·¨è™Ÿ
- payment_date (TIMESTAMP)
- notes (TEXT) -- å‚™è¨»
- remark (TEXT) -- ç”¨æ–¼ manual_price_override æ¨™è¨˜
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_orders_user
- idx_orders_status
- idx_orders_timestamp
- idx_orders_merchant_trade_no
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `user_id, timestamp, item, card_no, quantity, unit_price, deposit, balance_amount, total_fee, status, is_cleared, is_shipped, arrival_status, box_order`

---

#### 3. **breaks** (åœ˜æ‹†è¨˜éŒ„è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- break_id (VARCHAR(50), NOT NULL) -- åœ˜æ‹†ç·¨è™Ÿ
- user_id (UUID, FK â†’ users.id)
- name (VARCHAR(200)) -- åœ˜æ‹†åç¨±
- category (VARCHAR(50), DEFAULT 'æ£’çƒ') -- åˆ†é¡
- format (VARCHAR(50), DEFAULT 'éš¨æ©Ÿ') -- æ ¼å¼ï¼šéš¨æ©Ÿ/PYT/æŒ‡å®š
- item (VARCHAR(200)) -- é—œè¯å•†å“
- total_fee (DECIMAL(10,2), NOT NULL)
- paid (DECIMAL(10,2), DEFAULT 0)
- balance (DECIMAL(10,2)) -- è¨ˆç®—æ¬„ä½
- status (VARCHAR(50), DEFAULT 'å·²é€šçŸ¥')
- is_opened (BOOLEAN, DEFAULT FALSE) -- æ˜¯å¦å·²æ‹†
- is_shipped (BOOLEAN, DEFAULT FALSE) -- æ˜¯å¦å·²å‡ºè²¨
- is_cleared (BOOLEAN, DEFAULT FALSE) -- æ˜¯å¦å·²çµæ¸…
- payment_method (VARCHAR(50))
- merchant_trade_no (VARCHAR(100))
- payment_date (TIMESTAMP)
- remark (TEXT)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_breaks_user
- idx_breaks_break_id
- idx_breaks_status
- idx_breaks_category
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `break_id, user_id, name, category, format, item, total_fee, paid, status, is_opened, is_shipped, is_cleared`

---

#### 4. **product_catalog** (å•†å“ç›®éŒ„è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- item_name (VARCHAR(200), NOT NULL) -- å•†å“åç¨±
- card_no (VARCHAR(50)) -- å¡è™Ÿ
- price (DECIMAL(10,2)) -- åŸåƒ¹
- threshold_price (DECIMAL(10,2)) -- é–€æª»åƒ¹
- discount_threshold (INTEGER) -- é–€æª»å¼µæ•¸
- stock_status (VARCHAR(50)) -- åº«å­˜ç‹€æ…‹
- is_box_preorder (VARCHAR(10)) -- æ˜¯å¦ç‚ºæ•´ç›’é è³¼
- can_direct_order (VARCHAR(10)) -- æ˜¯å¦å¯ç›´æ¥è¨‚è³¼
- is_available (VARCHAR(10), DEFAULT 'Y') -- æ˜¯å¦é–‹æ”¾
- image_url_1 (TEXT)
- image_url_2 (TEXT)
- image_url_3 (TEXT)
- image_url_4 (TEXT)
- scheduled_delist_time (TIMESTAMP) -- é å®šä¸‹æ¶æ™‚é–“
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_catalog_item
- idx_catalog_cardno
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `item_name, card_no, price, threshold_price, discount_threshold, stock_status, is_box_preorder, can_direct_order, is_available`

---

#### 5. **break_credits** (åœ˜æ‹†é‡‘è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- user_id (UUID, FK â†’ users.id)
- amount (DECIMAL(10,2), NOT NULL) -- é‡‘é¡
- source (VARCHAR(100)) -- ä¾†æº
- is_used (BOOLEAN, DEFAULT FALSE) -- æ˜¯å¦å·²ä½¿ç”¨
- used_break_ids (TEXT) -- å·²ä½¿ç”¨çš„åœ˜æ‹† IDï¼ˆå­—ä¸²æ ¼å¼ï¼‰
- used_amount (DECIMAL(10,2), DEFAULT 0) -- å·²ä½¿ç”¨é‡‘é¡
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_credits_user
- idx_credits_is_used
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `user_id, amount, source, is_used, used_break_ids, used_amount`

---

#### 6. **payments** (ä»˜æ¬¾è¨˜éŒ„è¡¨) - ç¶ ç•Œæ•´åˆç”¨
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- merchant_trade_no (VARCHAR(100), UNIQUE, NOT NULL) -- å•†å®¶äº¤æ˜“ç·¨è™Ÿ
- user_id (UUID, FK â†’ users.id)
- amount (DECIMAL(10,2), NOT NULL)
- payment_type (VARCHAR(20)) -- order/break
- payment_method (VARCHAR(50), DEFAULT 'ç¶ ç•Œä¿¡ç”¨å¡')
- status (VARCHAR(50), DEFAULT 'pending') -- pending/success/failed
- trade_no (VARCHAR(100)) -- ç¶ ç•Œäº¤æ˜“ç·¨è™Ÿ
- payment_date (TIMESTAMP)
- order_details (JSONB) -- è¨‚å–®è©³æƒ…
- rtn_msg (TEXT) -- ç¶ ç•Œå›å‚³è¨Šæ¯
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_payments_merchant_trade_no
- idx_payments_user
- idx_payments_status
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `merchant_trade_no, user_id, amount, payment_type, status, payment_date`

---

#### 7. **shipments** (å‡ºè²¨ç´€éŒ„è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- user_id (UUID, FK â†’ users.id)
- shipment_no (VARCHAR(50)) -- å‡ºè²¨ç·¨è™Ÿ
- shipment_date (TIMESTAMP) -- å‡ºè²¨æ—¥æœŸ
- nickname (VARCHAR(50)) -- ç¾¤çµ„æš±ç¨±
- real_name (VARCHAR(100)) -- çœŸå¯¦å§“å
- phone (VARCHAR(20))
- ship_store (VARCHAR(200)) -- æ”¶ä»¶é–€å¸‚
- store_number (VARCHAR(20)) -- 711åº—è™Ÿ
- tracking_no (VARCHAR(100)) -- ç‰©æµå–®è™Ÿ
- items (JSONB) -- å•†å“æ˜ç´°
- status (VARCHAR(50), DEFAULT 'pending') -- pending/shipped/delivered
- remark (TEXT)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_shipments_user
- idx_shipments_tracking
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `user_id, shipment_no, shipment_date, nickname, phone, ship_store, tracking_no, status`

---

#### 8. **notifications** (ä»˜æ¬¾é€šçŸ¥è¡¨)
```sql
æ¬„ä½ï¼š
- id (UUID, PK)
- user_id (UUID, FK â†’ users.id)
- type (VARCHAR(50)) -- é€šçŸ¥é¡å‹
- message (TEXT) -- é€šçŸ¥è¨Šæ¯
- is_read (BOOLEAN, DEFAULT FALSE)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)

ç´¢å¼•ï¼š
- idx_notifications_user
- idx_notifications_type
```

**CSV åŒ¯å‡ºæ¬„ä½ï¼š** `user_id, type, message, is_read`

---

### å¯é¸è³‡æ–™è¡¨ï¼ˆè¦–éœ€æ±‚é·ç§»ï¼‰

#### 9. **psa_orders** (PSA é‘‘å®šè¨‚å–®) - å¦‚æœ‰ä½¿ç”¨
#### 10. **psa_card_details** (PSA å¡ç‰‡æ˜ç´°) - å¦‚æœ‰ä½¿ç”¨
#### 11. **lottery** (æ¯æ—¥æŠ½ç±¤/é‹å‹¢) - å¦‚æœ‰ä½¿ç”¨

---

## ğŸš€ ä»»å‹™ä¸‰ï¼šæ­£å¼ç’°å¢ƒé·ç§»æª¢æŸ¥æ¸…å–®

### 1. ç¶²åŸŸé…ç½®
- [ ] è¨­å®š DNSï¼š`www.ningscard.com` â†’ Cloudflare Workers
- [ ] è¨­å®š SSL æ†‘è­‰ï¼ˆCloudflare è‡ªå‹•è™•ç†ï¼‰
- [ ] æ¸¬è©¦ç¶²åŸŸè§£æ

### 2. Supabase æ­£å¼ç’°å¢ƒ
- [ ] å»ºç«‹æ–°çš„ Supabase å°ˆæ¡ˆï¼ˆæ­£å¼ç’°å¢ƒï¼‰
- [ ] åŸ·è¡Œ Schema å»ºç«‹ SQLï¼š`/supabase_migration/schema.sql`
- [ ] åœç”¨ RLSï¼š`/supabase_migration/disable_rls.sql`
- [ ] åŒ¯å…¥ CSV è³‡æ–™åˆ°å„è¡¨
- [ ] é©—è­‰è³‡æ–™å®Œæ•´æ€§
- [ ] è¨˜éŒ„æ–°çš„ Supabase URL å’Œ API Key

### 3. ç¶ ç•Œé‡‘æµè¨­å®š
**ç›®å‰æ˜¯æ¸¬è©¦ç’°å¢ƒï¼Œéœ€è¦æ”¹ç‚ºæ­£å¼ç’°å¢ƒï¼š**

#### Backend (worker.js) éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ï¼š

**ä½ç½® 1: ç¶ ç•Œè¨­å®š (ç´„ line 1300-1400)**
```javascript
// âŒ æ¸¬è©¦ç’°å¢ƒ
const ECPAY_MERCHANT_ID = '3002607'; // æ¸¬è©¦å•†åº—ä»£è™Ÿ
const ECPAY_HASH_KEY = 'pwFHCqoQZGmho4w6'; // æ¸¬è©¦ HashKey
const ECPAY_HASH_IV = 'EkRm7iFT261dpevs'; // æ¸¬è©¦ HashIV
const ECPAY_API_URL = 'https://payment-stage.ecpay.com.tw/Cashier/AioCheckOut/V5'; // æ¸¬è©¦ç¶²å€

// âœ… æ­£å¼ç’°å¢ƒï¼ˆéœ€å‘ç¶ ç•Œç”³è«‹ï¼‰
const ECPAY_MERCHANT_ID = 'YOUR_PRODUCTION_MERCHANT_ID';
const ECPAY_HASH_KEY = 'YOUR_PRODUCTION_HASH_KEY';
const ECPAY_HASH_IV = 'YOUR_PRODUCTION_HASH_IV';
const ECPAY_API_URL = 'https://payment.ecpay.com.tw/Cashier/AioCheckOut/V5'; // æ­£å¼ç¶²å€
```

**ä½ç½® 2: ReturnURL / OrderResultURL**
```javascript
// âŒ æ¸¬è©¦ç’°å¢ƒ
ReturnURL: 'https://ningscard.pages.dev?ecpay=return'
OrderResultURL: 'https://ningscard-api.kuoch.workers.dev/api/ecpayCallback'

// âœ… æ­£å¼ç’°å¢ƒ
ReturnURL: 'https://www.ningscard.com?ecpay=return'
OrderResultURL: 'https://ä½ çš„æ­£å¼å¾Œç«¯ç¶²åŸŸ/api/ecpayCallback'
```

**ä½ç½® 3: ClientBackURL (ç”¨æˆ¶å–æ¶ˆä»˜æ¬¾è¿”å›)**
```javascript
ClientBackURL: 'https://www.ningscard.com'
```

#### ç¶ ç•Œæ­£å¼ç’°å¢ƒç”³è«‹æµç¨‹ï¼š
1. ç™»å…¥ç¶ ç•Œæœƒå“¡ä¸­å¿ƒ
2. ç”³è«‹ã€Œæ­£å¼ç’°å¢ƒã€å•†åº—
3. å–å¾—æ­£å¼ç’°å¢ƒçš„ï¼š
   - å•†åº—ä»£è™Ÿï¼ˆMerchantIDï¼‰
   - HashKey
   - HashIV
4. æ¸¬è©¦å°‘é‡çœŸå¯¦äº¤æ˜“
5. ç¢ºèª callback æ­£å¸¸é‹ä½œ

### 4. Cloudflare Workers éƒ¨ç½²

#### ç’°å¢ƒè®Šæ•¸è¨­å®š
```bash
# Supabase æ­£å¼ç’°å¢ƒ
SUPABASE_URL=https://ä½ çš„æ­£å¼å°ˆæ¡ˆ.supabase.co
SUPABASE_ANON_KEY=ä½ çš„æ­£å¼_anon_key

# ç¶ ç•Œæ­£å¼ç’°å¢ƒ
ECPAY_MERCHANT_ID=ä½ çš„æ­£å¼å•†åº—ä»£è™Ÿ
ECPAY_HASH_KEY=ä½ çš„æ­£å¼HashKey
ECPAY_HASH_IV=ä½ çš„æ­£å¼HashIV
```

#### éƒ¨ç½²æ­¥é©Ÿ
```bash
cd /Users/kuoch/NINGSCARDGASDEMO

# 1. æ›´æ–° wrangler.toml è¨­å®šæ­£å¼ç’°å¢ƒè®Šæ•¸
# 2. éƒ¨ç½²å¾Œç«¯ Worker
wrangler deploy backend/worker.js --name ningscard-api-prod

# 3. éƒ¨ç½²å‰ç«¯
# å°‡ separated/frontend/ çš„æª”æ¡ˆä¸Šå‚³åˆ° Cloudflare Pages
# ä¸¦ç¶å®šåˆ° www.ningscard.com
```

### 5. å‰ç«¯ API ç«¯é»æ›´æ–°

**index.html å’Œ admin.html éœ€è¦ä¿®æ”¹ï¼š**
```javascript
// âŒ æ¸¬è©¦ç’°å¢ƒ
const API_BASE_URL = 'https://ningscard-api.kuoch.workers.dev/api';

// âœ… æ­£å¼ç’°å¢ƒ
const API_BASE_URL = 'https://ä½ çš„æ­£å¼å¾Œç«¯ç¶²åŸŸ/api';
```

### 6. å…¶ä»–éœ€è¦æª¢æŸ¥çš„è¨­å®š

- [ ] **CORS è¨­å®š**ï¼šç¢ºèª worker.js ä¸­çš„ CORS headers å…è¨± www.ningscard.com
- [ ] **åœ–ç‰‡ URL**ï¼šç¢ºèªå•†å“åœ–ç‰‡é€£çµæ˜¯å¦éœ€è¦æ›´æ–°
- [ ] **Email é€šçŸ¥**ï¼šå¦‚æœ‰ä½¿ç”¨ email é€šçŸ¥ï¼Œæª¢æŸ¥å¯„ä»¶è¨­å®š
- [ ] **å‚™ä»½æ©Ÿåˆ¶**ï¼šè¨­å®š Supabase è‡ªå‹•å‚™ä»½
- [ ] **ç›£æ§å‘Šè­¦**ï¼šè¨­å®š Cloudflare Workers ç›£æ§
- [ ] **æ•ˆèƒ½æ¸¬è©¦**ï¼šé€²è¡Œå£“åŠ›æ¸¬è©¦ç¢ºèªæ•ˆèƒ½
- [ ] **å®‰å…¨æª¢æŸ¥**ï¼š
  - ç¢ºèªæ‰€æœ‰ API éƒ½æœ‰ç”Ÿæ—¥é©—è­‰ï¼ˆå·²å®Œæˆï¼‰
  - æª¢æŸ¥ SQL injection é˜²è­·
  - æª¢æŸ¥ XSS é˜²è­·

### 7. æ¸¬è©¦æµç¨‹

**ä¸Šç·šå‰å¿…æ¸¬é …ç›®ï¼š**
- [ ] ç”¨æˆ¶è¨»å†Š/ç™»å…¥
- [ ] ç€è¦½å•†å“
- [ ] åŠ å…¥è³¼ç‰©è»Š
- [ ] ç¶ ç•Œä»˜æ¬¾æµç¨‹ï¼ˆå°é¡æ¸¬è©¦ï¼‰
- [ ] ä»˜æ¬¾æˆåŠŸå›èª¿
- [ ] è¨‚å–®ç‹€æ…‹æ›´æ–°
- [ ] åœ˜æ‹†åŠŸèƒ½
- [ ] å‡ºè²¨åŠŸèƒ½
- [ ] Admin å¾Œå°æ‰€æœ‰åŠŸèƒ½

### 8. ä¸Šç·šæ­¥é©Ÿå»ºè­°

1. **å…ˆéƒ¨ç½²å¾Œç«¯** â†’ æ¸¬è©¦ API
2. **éƒ¨ç½²å‰ç«¯** â†’ æ¸¬è©¦å®Œæ•´æµç¨‹
3. **å°é¡çœŸå¯¦äº¤æ˜“æ¸¬è©¦** â†’ ç¢ºèªé‡‘æµ
4. **é–‹æ”¾å°‘é‡ç”¨æˆ¶æ¸¬è©¦** â†’ æ”¶é›†å›é¥‹
5. **æ­£å¼ä¸Šç·š** â†’ ç›£æ§ç³»çµ±ç‹€æ…‹
6. **ä¿ç•™èˆŠç³»çµ±** â†’ è‡³å°‘1é€±ä½œç‚ºå‚™æ´

---

## ğŸ“ CSV åŒ¯å‡ºæº–å‚™æ¸…å–®

### å¿…é ˆåŒ¯å‡ºçš„è³‡æ–™è¡¨ï¼ˆæŒ‰å„ªå…ˆé †åºï¼‰

1. **users.csv** - ç”¨æˆ¶è³‡æ–™
2. **product_catalog.csv** - å•†å“ç›®éŒ„
3. **orders.csv** - è¨‚å–®è¨˜éŒ„
4. **breaks.csv** - åœ˜æ‹†è¨˜éŒ„
5. **break_credits.csv** - åœ˜æ‹†é‡‘
6. **shipments.csv** - å‡ºè²¨è¨˜éŒ„
7. **payments.csv** - ä»˜æ¬¾è¨˜éŒ„ï¼ˆåƒ…ä¿ç•™å·²å®Œæˆçš„ï¼‰
8. **notifications.csv** - é€šçŸ¥è¨˜éŒ„ï¼ˆå¯é¸ï¼‰

### è³‡æ–™æ¸…ç†å»ºè­°

**é·ç§»å‰æ‡‰è©²æ¸…ç†ï¼š**
- æ¸¬è©¦ç”¨æˆ¶è³‡æ–™
- æ¸¬è©¦è¨‚å–®
- å¤±æ•—çš„ä»˜æ¬¾è¨˜éŒ„ï¼ˆstatus = 'failed'ï¼‰
- éæœŸçš„å•†å“
- ç„¡æ•ˆçš„åœ˜æ‹†è¨˜éŒ„

**å¿…é ˆä¿ç•™ï¼š**
- æ‰€æœ‰çœŸå¯¦ç”¨æˆ¶
- æ‰€æœ‰å·²å®Œæˆçš„è¨‚å–®
- æ‰€æœ‰å·²çµæ¸…çš„åœ˜æ‹†
- æ‰€æœ‰æˆåŠŸçš„ä»˜æ¬¾è¨˜éŒ„
- æ‰€æœ‰å‡ºè²¨è¨˜éŒ„

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é …

1. **è³‡æ–™åº«é·ç§»æ™‚æ©Ÿ**ï¼šå»ºè­°åœ¨ä½æµé‡æ™‚æ®µï¼ˆæ·±å¤œï¼‰é€²è¡Œ
2. **å‚™ä»½**ï¼šé·ç§»å‰å‹™å¿…å®Œæ•´å‚™ä»½ç¾æœ‰è³‡æ–™
3. **æ¸¬è©¦æœŸ**ï¼šæ­£å¼ä¸Šç·šå¾Œä¿æŒå¯†åˆ‡ç›£æ§è‡³å°‘ 3-7 å¤©
4. **å›æ»¾è¨ˆç•«**ï¼šæº–å‚™å›æ»¾åˆ°èˆŠç³»çµ±çš„æ‡‰æ€¥æ–¹æ¡ˆ
5. **ç”¨æˆ¶é€šçŸ¥**ï¼šæå‰é€šçŸ¥ç”¨æˆ¶ç³»çµ±ç¶­è­·æ™‚é–“

---

## ğŸ“ ç¶ ç•Œå®¢æœè¯çµ¡æ–¹å¼

- å®¢æœé›»è©±ï¼š02-2655-0115
- æœå‹™æ™‚é–“ï¼šé€±ä¸€è‡³é€±äº” 09:00-18:00
- æœƒå“¡ä¸­å¿ƒï¼šhttps://vendor.ecpay.com.tw/
- æŠ€è¡“æ–‡ä»¶ï¼šhttps://developers.ecpay.com.tw/

---

## ğŸ¯ é·ç§»å®Œæˆé©—è­‰

ä¸Šç·šå¾Œå¿…é ˆé©—è­‰ï¼š
- [ ] æ‰€æœ‰ç”¨æˆ¶éƒ½èƒ½æ­£å¸¸ç™»å…¥
- [ ] è¨‚å–®è³‡æ–™å®Œæ•´é¡¯ç¤º
- [ ] ç¶ ç•Œä»˜æ¬¾æ¸¬è©¦æˆåŠŸï¼ˆå°é¡ï¼‰
- [ ] åœ˜æ‹†åŠŸèƒ½æ­£å¸¸
- [ ] Admin åŠŸèƒ½æ­£å¸¸
- [ ] æ•ˆèƒ½ç¬¦åˆé æœŸ
- [ ] ç„¡å®‰å…¨æ¼æ´
- [ ] ç›£æ§ç³»çµ±æ­£å¸¸é‹ä½œ
