# ğŸ“¦ è³‡æ–™é·ç§»å·¥å…·åŒ…

å®Œæ•´çš„ CSV â†’ Supabase è³‡æ–™é·ç§»è§£æ±ºæ–¹æ¡ˆ

---

## ğŸ“š æ–‡ä»¶èªªæ˜

### 1. `DATABASE_TABLES_COMPLETE.md` 
**è³‡æ–™åº«å®Œæ•´è¡¨æ ¼èˆ‡æ¬„ä½æ¸…å–®**

- 11 å€‹è³‡æ–™è¡¨çš„å®Œæ•´æ¬„ä½å®šç¾©
- æ¯å€‹æ¬„ä½çš„ç”¨é€”èªªæ˜
- ç¨‹å¼ç¢¼ä½¿ç”¨ä½ç½®ï¼ˆè¡Œè™Ÿï¼‰
- å¤–éµé—œä¿‚åœ–
- é·ç§»å„ªå…ˆé †åºå»ºè­°

**ä½•æ™‚ä½¿ç”¨ï¼š**
- æº–å‚™ CSV åŒ¯å‡ºæ™‚ï¼Œç¢ºèªéœ€è¦å“ªäº›æ¬„ä½
- æª¢æŸ¥è¡¨æ ¼çµæ§‹æ˜¯å¦å®Œæ•´
- ç†è§£è³‡æ–™è¡¨ä¹‹é–“çš„é—œä¿‚

---

### 2. `MIGRATION_CHECKLIST.md`
**è³‡æ–™é·ç§»åŸ·è¡Œæª¢æŸ¥æ¸…å–®**

- é·ç§»å‰æº–å‚™æ­¥é©Ÿ
- é·ç§»åŸ·è¡ŒæŒ‡ä»¤
- é·ç§»å¾Œé©—è­‰ SQL
- å¸¸è¦‹éŒ¯èª¤è™•ç†
- é æœŸé·ç§»çµæœ

**ä½•æ™‚ä½¿ç”¨ï¼š**
- åŸ·è¡Œé·ç§»å‰çš„æº–å‚™ç¢ºèª
- é·ç§»éç¨‹ä¸­é‡åˆ°å•é¡Œ
- é·ç§»å®Œæˆå¾Œçš„è³‡æ–™é©—è­‰

---

## ğŸ› ï¸ å·¥å…·è…³æœ¬

### 1. `migrate_all_tables.js` âœ¨ **ä¸»è¦é·ç§»è…³æœ¬**

**åŠŸèƒ½ï¼š** æ”¯æ´æ‰€æœ‰ 11 å€‹è³‡æ–™è¡¨çš„å®Œæ•´é·ç§»

**åŸºæœ¬ç”¨æ³•ï¼š**
```bash
cd supabase_backend
node migrate_all_tables.js
```

**é€²éšç”¨æ³•ï¼š**
```bash
# è·³éå·²é·ç§»çš„ç”¨æˆ¶å’Œå•†å“
SKIP_USERS=1 SKIP_PRODUCTS=1 node migrate_all_tables.js

# åªé·ç§»è¨‚å–®å’Œåœ˜æ‹†
SKIP_USERS=1 SKIP_PRODUCTS=1 SKIP_SHIPMENTS=1 SKIP_CREDITS=1 SKIP_LOTTERY=1 SKIP_ECPAY=1 SKIP_PSA=1 SKIP_HISTORY=1 node migrate_all_tables.js

# åªé·ç§»è¼”åŠ©è³‡æ–™
SKIP_USERS=1 SKIP_PRODUCTS=1 SKIP_ORDERS=1 SKIP_BREAKS=1 node migrate_all_tables.js
```

**ç’°å¢ƒè®Šæ•¸æ§åˆ¶ï¼š**
- `SKIP_USERS=1` - è·³éç”¨æˆ¶é·ç§»
- `SKIP_PRODUCTS=1` - è·³éå•†å“é·ç§»
- `SKIP_ORDERS=1` - è·³éè¨‚å–®é·ç§»
- `SKIP_BREAKS=1` - è·³éåœ˜æ‹†é·ç§»
- `SKIP_SHIPMENTS=1` - è·³éå‡ºè²¨é·ç§»
- `SKIP_CREDITS=1` - è·³éåœ˜æ‹†é‡‘é·ç§»
- `SKIP_NOTIFICATIONS=1` - è·³éä»˜æ¬¾é€šçŸ¥é·ç§»
- `SKIP_LOTTERY=1` - è·³éæŠ½ç±¤é·ç§»
- `SKIP_ECPAY=1` - è·³éç¶ ç•Œè¨˜éŒ„é·ç§»
- `SKIP_PSA=1` - è·³éPSAè¨‚å–®é·ç§»
- `SKIP_HISTORY=1` - è·³éè¨‚å–®æ­·å²é·ç§»

**è¼¸å‡ºç¯„ä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘        ğŸ“¦ å®Œæ•´è³‡æ–™é·ç§»è…³æœ¬ v3 - æ”¯æ´ 11 å€‹è³‡æ–™è¡¨      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”— é€£ç·šåˆ° Supabase: https://xxx.supabase.co

ğŸ“‚ è®€å– CSV æª”æ¡ˆ...

âœ… è®€å– å®¢æˆ¶è³‡æ–™.csv: 150 ç­†
âœ… è®€å– ä¸‹å–®å•†å“.csv: 300 ç­†
âœ… è®€å– Topps_Now_è¨‚è³¼ç¸½è¡¨.csv: 1200 ç­†
...

ğŸ“Œ [1/11] é·ç§»ç”¨æˆ¶è³‡æ–™...
æº–å‚™æ’å…¥ 150 ç­†ç”¨æˆ¶
âœ… å·²æ’å…¥ 150/150 ç­†ç”¨æˆ¶

ğŸ“Œ [2/11] é·ç§»å•†å“è³‡æ–™...
æº–å‚™æ’å…¥ 300 ç­†å•†å“
âœ… å·²æ’å…¥ 300/300 ç­†å•†å“

...

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  âœ… é·ç§»å®Œæˆçµ±è¨ˆ                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š [1] ç”¨æˆ¶è³‡æ–™:       150 ç­†
ğŸ“¦ [2] å•†å“è³‡æ–™:       300 ç­†
ğŸ“‹ [3] è¨‚å–®è³‡æ–™:       1200 ç­†
ğŸ¯ [4] åœ˜æ‹†è¨˜éŒ„:       500 ç­†
ğŸ“® [5] å‡ºè²¨è¨˜éŒ„:       200 ç­†
ğŸ’° [6] åœ˜æ‹†é‡‘:         50 ç­†
ğŸ”” [7] ä»˜æ¬¾é€šçŸ¥:       0 ç­†
ğŸ² [8] æŠ½ç±¤è¨˜éŒ„:       300 ç­†
ğŸ’³ [9] ç¶ ç•Œè¨˜éŒ„:       400 ç­†
ğŸ“œ [10] PSA è¨‚å–®:      10 ç­†
ğŸ“š [11] è¨‚å–®æ­·å²:      800 ç­†

ğŸ’¡ ç”¨æˆ¶å°æ‡‰è¡¨:      150 å€‹ phone/nickname â†’ user_id

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ‰ å®Œæ•´è³‡æ–™é·ç§»å®Œæˆï¼                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

### 2. `verify_migration.js` ğŸ” **é·ç§»é©—è­‰è…³æœ¬**

**åŠŸèƒ½ï¼š** é©—è­‰é·ç§»å¾Œçš„è³‡æ–™å®Œæ•´æ€§

**ç”¨æ³•ï¼š**
```bash
cd supabase_backend
node verify_migration.js
```

**æª¢æŸ¥é …ç›®ï¼š**
1. âœ… è³‡æ–™ç­†æ•¸çµ±è¨ˆ
2. âœ… å¤–éµå®Œæ•´æ€§ï¼ˆuser_id æ˜¯å¦æœ‰æ•ˆï¼‰
3. âœ… å¿…å¡«æ¬„ä½æª¢æŸ¥
4. âœ… æŠ½æ¨£è³‡æ–™æª¢æŸ¥
5. âœ… è³‡æ–™ç¯„åœæª¢æŸ¥ï¼ˆåƒ¹æ ¼ã€é‡‘é¡ï¼‰

**è¼¸å‡ºç¯„ä¾‹ï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              ğŸ” è³‡æ–™é·ç§»é©—è­‰å ±å‘Š                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š æª¢æŸ¥è³‡æ–™ç­†æ•¸...

  âœ… users                 - 150 ç­†
  âœ… product_catalog       - 300 ç­†
  âœ… orders                - 1200 ç­†
  âœ… breaks                - 500 ç­†
  âœ… shipments             - 200 ç­†
  âœ… break_credits         - 50 ç­†
  âš ï¸  notifications        - 0 ç­†
  âœ… lottery               - 300 ç­†
  âœ… ecpay_records         - 400 ç­†
  âœ… psa_orders            - 10 ç­†
  âœ… order_history         - 800 ç­†

ğŸ”— æª¢æŸ¥å¤–éµå®Œæ•´æ€§...

  âœ… è¨‚å–®çš„ç”¨æˆ¶: 1200 ç­†æœ‰æ•ˆ, 0 ç­†ç„¡ user_id
  âœ… åœ˜æ‹†çš„ç”¨æˆ¶: 500 ç­†æœ‰æ•ˆ, 0 ç­†ç„¡ user_id
  âœ… å‡ºè²¨çš„ç”¨æˆ¶: 200 ç­†æœ‰æ•ˆ, 0 ç­†ç„¡ user_id
  âœ… åœ˜æ‹†é‡‘çš„ç”¨æˆ¶: 50 ç­†æœ‰æ•ˆ, 0 ç­†ç„¡ user_id
  âœ… æŠ½ç±¤çš„ç”¨æˆ¶: 300 ç­†æœ‰æ•ˆ, 0 ç­†ç„¡ user_id
  âœ… ç¶ ç•Œè¨˜éŒ„çš„ç”¨æˆ¶: 400 ç­†æœ‰æ•ˆ, 0 ç­†ç„¡ user_id

ğŸ“ æª¢æŸ¥å¿…å¡«æ¬„ä½...

  âœ… users: æ‰€æœ‰è¨˜éŒ„éƒ½æœ‰ phone å’Œ birthday
  âœ… orders: æ‰€æœ‰è¨˜éŒ„éƒ½æœ‰ item å’Œ total_fee
  âœ… breaks: æ‰€æœ‰è¨˜éŒ„éƒ½æœ‰ break_id å’Œ total_fee
  âœ… product_catalog: æ‰€æœ‰è¨˜éŒ„éƒ½æœ‰ item_name

ğŸ² æŠ½æ¨£æª¢æŸ¥è³‡æ–™...

  ğŸ‘¤ éš¨æ©Ÿç”¨æˆ¶: Ning (975313096)
     - è¨‚å–®æ•¸: 25 ç­†
     - åœ˜æ‹†æ•¸: 10 ç­†
     - åœ˜æ‹†é‡‘: 2 ç­†

ğŸ“ æª¢æŸ¥è³‡æ–™ç¯„åœ...

  ğŸ’° å•†å“åƒ¹æ ¼: æœ€ä½ $50, æœ€é«˜ $8000, å¹³å‡ $450.25
  ğŸ“‹ è¨‚å–®é‡‘é¡: æœ€ä½ $50, æœ€é«˜ $5000, å¹³å‡ $320.50

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    é©—è­‰ç¸½çµ                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š ç¸½è³‡æ–™ç­†æ•¸: 3910
ğŸ”— å¤–éµå®Œæ•´æ€§: âœ… é€šé
ğŸ“ å¿…å¡«æ¬„ä½: âœ… é€šé

ğŸ‰ æ‰€æœ‰é©—è­‰é€šéï¼è³‡æ–™é·ç§»æˆåŠŸï¼
```

---

## ğŸ“‹ éœ€è¦çš„ CSV æª”æ¡ˆ

### æ ¸å¿ƒæª”æ¡ˆï¼ˆå¿…é ˆï¼‰- 9 å€‹

| CSV æª”æ¡ˆ | å°æ‡‰è¡¨æ ¼ | èªªæ˜ |
|---------|---------|------|
| `å®¢æˆ¶è³‡æ–™.csv` | users | ç”¨æˆ¶åŸºæœ¬è³‡æ–™ |
| `ä¸‹å–®å•†å“.csv` | product_catalog | å•†å“ç›®éŒ„ |
| `Topps_Now_è¨‚è³¼ç¸½è¡¨.csv` | orders | è¨‚å–®è¨˜éŒ„ |
| `åœ˜æ‹†ç´€éŒ„.csv` | breaks | åœ˜æ‹†è¨˜éŒ„ |
| `å‡ºè²¨ç´€éŒ„.csv` | shipments | å‡ºè²¨è¨˜éŒ„ |
| `åœ˜æ‹†é‡‘.csv` | break_credits | åœ˜æ‹†é‡‘ |
| `æ¯æ—¥æŠ½ç±¤ç´€éŒ„.csv` | lottery | æŠ½ç±¤è¨˜éŒ„ |
| `ç¶ ç•Œä»˜æ¬¾è¨˜éŒ„.csv` | ecpay_records | ç¶ ç•Œäº¤æ˜“ |
| *(æš«ç„¡ CSV)* | notifications | ä»˜æ¬¾é€šçŸ¥ |

### å¯é¸æª”æ¡ˆ - 2 å€‹

| CSV æª”æ¡ˆ | å°æ‡‰è¡¨æ ¼ | èªªæ˜ |
|---------|---------|------|
| `ä¸»è¨‚å–®.csv` | psa_orders | PSA é‘‘å®šè¨‚å–® |
| `è¨‚å–®æ­·å²ç´€éŒ„.csv` | order_history | è¨‚å–®æ­·å² |

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. ç’°å¢ƒè¨­å®š

```bash
cd supabase_backend

# å®‰è£ç›¸ä¾å¥—ä»¶
npm install

# è¨­å®šç’°å¢ƒè®Šæ•¸
cp .env.example .env
nano .env  # å¡«å…¥ SUPABASE_URL å’Œ SUPABASE_ANON_KEY
```

### 2. æº–å‚™ CSV æª”æ¡ˆ

ç¢ºä¿æ‰€æœ‰éœ€è¦çš„ CSV æª”æ¡ˆéƒ½åœ¨ `supabase_backend/` ç›®éŒ„ä¸‹ï¼š

```bash
ls -lh *.csv
```

### 3. åŸ·è¡Œé·ç§»

```bash
# å®Œæ•´é·ç§»
node migrate_all_tables.js
```

### 4. é©—è­‰è³‡æ–™

```bash
# åŸ·è¡Œé©—è­‰è…³æœ¬
node verify_migration.js
```

### 5. æ¸¬è©¦å‰ç«¯

é–‹å•Ÿå‰ç«¯æ¸¬è©¦ç™»å…¥ã€è¨‚å–®ã€åœ˜æ‹†ç­‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸ã€‚

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é …

### é·ç§»é †åºå¾ˆé‡è¦

**å¿…é ˆæŒ‰ç…§ä»¥ä¸‹é †åºï¼š**
1. âœ… **users** - å¿…é ˆç¬¬ä¸€å€‹ï¼ˆå…¶ä»–è¡¨ä¾è³´ user_idï¼‰
2. âœ… **product_catalog** - å¿…é ˆç¬¬äºŒå€‹ï¼ˆè¨‚å–®ä¾è³´å•†å“ï¼‰
3. å…¶ä»–è¡¨æ ¼é †åºä¸é™

è…³æœ¬å·²è‡ªå‹•è™•ç†é †åºï¼Œä½†å¦‚æœæ‰‹å‹•é·ç§»è«‹æ³¨æ„ï¼

### å¤–éµé—œä¿‚

æ‰€æœ‰è¡¨æ ¼ï¼ˆé™¤äº† users å’Œ product_catalogï¼‰éƒ½ä¾è³´ `user_id`ï¼š

```
users.id
  â”œâ”€â†’ orders.user_id
  â”œâ”€â†’ breaks.user_id
  â”œâ”€â†’ shipments.user_id
  â”œâ”€â†’ break_credits.user_id
  â”œâ”€â†’ notifications.user_id
  â”œâ”€â†’ lottery.user_id
  â”œâ”€â†’ ecpay_records.user_id
  â”œâ”€â†’ psa_orders.user_id
  â””â”€â†’ order_history.user_id
```

**é—œéµï¼š** è…³æœ¬æœƒè‡ªå‹•å»ºç«‹ `userMap` å°æ‡‰è¡¨ï¼Œå°‡ CSV ä¸­çš„ phone/nickname/real_name å°æ‡‰åˆ° Supabase çš„ user_idã€‚

### è³‡æ–™æ¸…ç†å»ºè­°

**é·ç§»å‰æ¸…ç†ï¼š**
- åˆªé™¤æ¸¬è©¦è³‡æ–™
- ç§»é™¤é‡è¤‡è¨˜éŒ„
- é©—è­‰è³‡æ–™æ ¼å¼

**é·ç§»å¾Œæ¸…ç†ï¼š**
- åˆªé™¤å¤±æ•—çš„ä»˜æ¬¾è¨˜éŒ„ï¼ˆecpay_records.status='failed'ï¼‰
- æ¸…é™¤ç„¡æ•ˆè¨‚å–®
- æª¢æŸ¥å­¤ç«‹è¨˜éŒ„

---

## ğŸ”§ é€²éšä½¿ç”¨

### åªé‡æ–°é·ç§»ç‰¹å®šè¡¨æ ¼

```bash
# åªé‡æ–°é·ç§»è¨‚å–®ï¼ˆå‡è¨­ç”¨æˆ¶å·²å­˜åœ¨ï¼‰
SKIP_USERS=1 SKIP_PRODUCTS=1 SKIP_BREAKS=1 SKIP_SHIPMENTS=1 SKIP_CREDITS=1 SKIP_LOTTERY=1 SKIP_ECPAY=1 SKIP_PSA=1 SKIP_HISTORY=1 node migrate_all_tables.js

# åªé‡æ–°é·ç§»ç¶ ç•Œè¨˜éŒ„
SKIP_USERS=1 SKIP_PRODUCTS=1 SKIP_ORDERS=1 SKIP_BREAKS=1 SKIP_SHIPMENTS=1 SKIP_CREDITS=1 SKIP_LOTTERY=1 SKIP_PSA=1 SKIP_HISTORY=1 node migrate_all_tables.js
```

### æ‰¹æ¬¡é·ç§»

```bash
# ç¬¬ä¸€æ‰¹ï¼šæ ¸å¿ƒç”¨æˆ¶å’Œå•†å“
node migrate_all_tables.js
# ç­‰å¾…å®Œæˆ...

# ç¬¬äºŒæ‰¹ï¼šæ¥­å‹™è³‡æ–™ï¼ˆè¨‚å–®ã€åœ˜æ‹†ï¼‰
SKIP_USERS=1 SKIP_PRODUCTS=1 SKIP_SHIPMENTS=1 SKIP_CREDITS=1 SKIP_LOTTERY=1 SKIP_ECPAY=1 SKIP_PSA=1 SKIP_HISTORY=1 node migrate_all_tables.js
# ç­‰å¾…å®Œæˆ...

# ç¬¬ä¸‰æ‰¹ï¼šè¼”åŠ©è³‡æ–™
SKIP_USERS=1 SKIP_PRODUCTS=1 SKIP_ORDERS=1 SKIP_BREAKS=1 node migrate_all_tables.js
```

### æ¸¬è©¦é·ç§»ï¼ˆå°æ‰¹æ¬¡ï¼‰

ä¿®æ”¹è…³æœ¬ä¸­çš„ `batchSize` å’Œ CSV è®€å–é‚è¼¯ï¼Œå…ˆé·ç§»å‰ 10 ç­†æ¸¬è©¦ï¼š

```javascript
// åœ¨ readCSV å‡½æ•¸å¾ŒåŠ å…¥
.on('end', () => {
  console.log(`âœ… è®€å– ${filename}: ${results.length} ç­†`);
  resolve(results.slice(0, 10)); // åªå–å‰ 10 ç­†æ¸¬è©¦
})
```

---

## ğŸ› å¸¸è¦‹å•é¡Œæ’æŸ¥

### å•é¡Œ 1: æ‰¾ä¸åˆ° user_id

**ç—‡ç‹€ï¼š**
```
æº–å‚™æ’å…¥ 1000 ç­†è¨‚å–® (500 ç­†æœ‰ user_id)
```

**åŸå› ï¼š** CSV ä¸­çš„ã€Œè¨‚è³¼äººã€æˆ–ã€Œè¯çµ¡æ–¹å¼ã€ç„¡æ³•å°æ‡‰åˆ°ç¾æœ‰ç”¨æˆ¶

**è§£æ±ºæ–¹æ³•ï¼š**
1. ç¢ºèª users è¡¨å·²å…ˆé·ç§»
2. æª¢æŸ¥ CSV ä¸­çš„é›»è©±æ ¼å¼æ˜¯å¦èˆ‡ users.phone ä¸€è‡´
3. æŸ¥çœ‹ç”¨æˆ¶å°æ‡‰è¡¨ï¼š`console.log(userMap)` æª¢æŸ¥æœ‰å“ªäº› key

### å•é¡Œ 2: æ—¥æœŸæ ¼å¼éŒ¯èª¤

**ç—‡ç‹€ï¼š**
```
âŒ æ’å…¥è¨‚å–®å¤±æ•—: invalid input syntax for type timestamp
```

**è§£æ±ºæ–¹æ³•ï¼š**
ä¿®æ”¹ `parseDate()` å‡½æ•¸æ”¯æ´æ‚¨çš„æ—¥æœŸæ ¼å¼ã€‚

### å•é¡Œ 3: é‡è¤‡ä¸»éµ

**ç—‡ç‹€ï¼š**
```
âŒ duplicate key value violates unique constraint
```

**è§£æ±ºæ–¹æ³•ï¼š**
- æ”¹ç”¨ `.upsert()` è€Œé `.insert()`
- æˆ–å…ˆæ¸…ç©ºè¡¨æ ¼å†é‡æ–°é·ç§»

### å•é¡Œ 4: é€£ç·šé€¾æ™‚

**ç—‡ç‹€ï¼š**
```
âŒ æŸ¥è©¢é€¾æ™‚
```

**è§£æ±ºæ–¹æ³•ï¼š**
- æ¸›å° `batchSize`ï¼ˆå¾ 100 æ”¹ç‚º 50 æˆ– 20ï¼‰
- åˆ†æ‰¹åŸ·è¡Œé·ç§»
- æª¢æŸ¥ç¶²è·¯é€£ç·š

---

## ğŸ“ éœ€è¦å”åŠ©ï¼Ÿ

1. æŸ¥çœ‹ `MIGRATION_CHECKLIST.md` çš„è©³ç´°æ­¥é©Ÿ
2. æª¢æŸ¥ Supabase Dashboard çš„ Logs
3. æŸ¥çœ‹ `DATABASE_TABLES_COMPLETE.md` ç¢ºèªè¡¨æ ¼çµæ§‹
4. ä½¿ç”¨ `verify_migration.js` è¨ºæ–·å•é¡Œ

---

## ğŸ“ ç‰ˆæœ¬æ­·å²

**v3.0** (2026-02-19)
- âœ… æ”¯æ´æ‰€æœ‰ 11 å€‹è³‡æ–™è¡¨
- âœ… æ–°å¢ ecpay_records é·ç§»
- âœ… æ–°å¢ lottery é·ç§»
- âœ… æ–°å¢å®Œæ•´é©—è­‰è…³æœ¬
- âœ… æ”¹é€²ç”¨æˆ¶å°æ‡‰æ©Ÿåˆ¶ï¼ˆæ”¯æ´ phone/nickname/real_nameï¼‰

**v2.0** (2025-12-27)
- æ”¯æ´ users, products, orders, breaks åŸºæœ¬é·ç§»

---

**Made with â¤ï¸ for Ning's Card Shop**
